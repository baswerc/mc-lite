package com.materialcentral.vulnerability.db.nvd

import arrow.core.Either
import arrow.core.left
import arrow.core.right
import com.beust.klaxon.JsonObject
import org.geezer.nonEmptyString

class NvdReference(
    val url: String,
    val source: String?,
) {

    companion object {
        fun map(json: JsonObject): Either<String, NvdReference> {
            val url = json.nonEmptyString("url") ?: return "Missing url property.".left()
            val source = json.nonEmptyString("source")
            return NvdReference(url, source).right()
        }
    }
}